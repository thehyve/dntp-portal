<div class="container-fluid">
    <div class="row">

        <!--Side Bar-->
        <div class="col-sm-3 col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                <li class="active"><a href="#/">{{'Overview'|translate}} <span class="sr-only">(current)</span></a></li>
                <li><a href="#/">Sub Menu #1</a></li>
                <li><a href="#/">Sub Menu #2</a></li>
                <li><a href="#/">Sub Menu #3</a></li>
            </ul>
        </div>

        <div ng-show="!authenticated">
            <div class="alert alert-danger" role="alert">
                {{ 'Not logged in' | translate }}
            </div>
        </div>

        <!--Main Content-->
        <div ng-if="authenticated" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" ng-controller="RequestController">

            <div ng-show="error" class="alert alert-danger" role="alert">
                {{ error | translate }}
            </div>

            <h1>{{ 'Requests' | translate }}</h1>
            <hr>
            <!--Tool bar-->
            <ul class="nav nav-pills">
                <li role="presentation" title="Create a new request" ng-show="isViewRequestsAllowed()">
                    <a href="#/" ng-click="start()">
                        <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>
                        {{'Create New Request'|translate}}
                    </a>
                </li>
            </ul>

            <!--List of request-->
            <div class="table-responsive" ng-if="authenticated">
                <table st-table="displayedCollection" st-safe-src="requests" class="table">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th st-sort="title">{{'Title'|translate}}</th>
                        <th st-sort="status">{{'Status'|translate}}</th>
                        <th st-sort="getters.dateCreated">{{'Created Date'|translate}}</th>
                        <th ng-if="roles.indexOf('palga') != -1"  st-sort="requesterName">{{'Requester'|translate}}</th>
                        <th ng-if="roles.indexOf('palga') != -1" st-sort="assigneeName">{{'Assignee'|translate}}</th>
                        <th>{{'Actions'|translate}}</th>
                    </tr>
                    <tr>
                        <th>&nbsp;</th>
                        <th><input st-search="title" placeholder="Filter by Title" class="input-sm form-control" type="search"/></th>
                        <th><input st-search="status" placeholder="Filter by Status" class="input-sm form-control" type="search"/></th>
                        <th>&nbsp;</th>
                        <th><input st-search="requesterName" placeholder="Filter by Requester" class="input-sm form-control" type="search"/></th>
                        <th><input st-search="assigneeName" placeholder="Filter by Assignee" class="input-sm form-control" type="search"/></th>
                        <th>&nbsp;</th>
                    </tr>
                    <tr>
                        <th>&nbsp;</th>
                        <th colspan="6"><input st-search="" class="form-control" placeholder="Search ..." type="text"/></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="req in displayedCollection" id="request_{{req.id}}">
                        <td>{{req.processInstanceId}}</td>
                        <td>{{req.title}}</td>
                        <td>{{req.status | translate}}</td>
                        <td>{{req.dateCreated | date: 'EEE dd MMMM yyyy'}}</td>
                        <td ng-if="roles.indexOf('palga') != -1" >{{req.requesterName}}</td>
                        <td ng-if="roles.indexOf('palga') != -1" >{{req.assigneeName == '' ? req.assignee : req.assigneeName}}</td>
                        <td>
                        <span class="pull-right">
                        <span class="btn-group">
                            <button
                                 class="btn btn-default" type="button" title="{{'Details'|translate}}" ng-click="view(req)">
                                {{'Details'|translate}}
                            </button>
                            <button
                                 ng-disabled="(req.status != 'Open' && roles.indexOf('palga') == -1) || (roles.indexOf('palga') != -1 && req.assignee != globals.currentUser.userid)"
                                 class="btn btn-default" type="button" title="{{'Edit'|translate}}" ng-click="edit(req)">
                                {{'Edit'|translate}}
                            </button>
                            <button ng-if="roles.indexOf('palga') != -1" ng-disabled="req.assignee == globals.currentUser.userid"
                                 class="btn btn-default" type="button" title="{{'Claim'|translate}}" ng-click="claim(req)">
                                {{'Claim'|translate}}
			    </button>
                            <button ng-if="roles.indexOf('palga') != -1" ng-disabled="req.assignee != globals.currentUser.userid"
                                 class="btn btn-default" type="button" title="{{'Unclaim'|translate}}" ng-click="unclaim(req)">
                                {{'Unclaim'|translate}}
                            </button>
                            <button
                                 ng-disabled="req.status != 'Open'"
                                 class="btn btn-default" type="button" title="{{'Delete'|translate}}" ng-click="remove(req)">
                                {{'Delete'|translate}}
                            </button>
                        </span>
                        </span>
                        </td>
                    </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="7" class="text-center">
                                <div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <!--=====================================================-->
            <!--TODO: To reuse table just change the result instance -->
            <!--=====================================================-->

        </div> <!--end Main Content-->

    </div>
</div>
