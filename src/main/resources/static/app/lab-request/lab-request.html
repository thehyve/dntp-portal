<div class="container-fluid" ng-controller="LabRequestController">
    <div class="row">

        <!--Side Bar-->
        <div class="col-sm-3 col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                <li class="active"><a href="#/">View</a></li>
            </ul>
        </div>

        <!--Main-->
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

            <h2>Lab Request: {{labRequest.taskId}}</h2>
            <hr>

        <!--Status-->
        <div class="form-group">
          <label class="control-label col-sm-3">{{ 'Status' | translate }}</label>
          <p class="col-sm-7">
            {{labRequest.status}}
            <br>
          </p>
        </div>

        <!--Rejected details-->
        <div ng-if="labRequest.status == 'Rejected'">
        <div class="form-group">
          <label class="control-label col-sm-3">{{ 'Reject date' | translate }}</label>
          <p class="col-sm-7">
            {{labRequest.rejectDate | date}}
            <br>
          </p>
        </div>
        <div class="form-group" ng-if="isLabUser()">
          <label class="control-label col-sm-3">{{ 'Reject reason' | translate }}</label>
          <p class="col-sm-7">
            {{labRequest.rejectReason}}
            <br><br>
            <a href="mailto:{{labRequest.requesterEmail}}?subject=Lab request rejected&amp;body=Lab request rejected.%0AReject reason: {{labRequest.rejectReason}}
                ">
            <button
            class="btn btn-default" type="button" title="{{'Compose rejection mail' | translate}}">
                <span><i class="glyphicon glyphicon-envelope"></i></span>
                {{'Compose rejection mail' | translate}}
            </button></a>
          </p>
        </div>
        </div>

        <!--Parent request details-->
        <div class="form-group">
          <label class="control-label col-sm-3">{{ 'Request Title' | translate }}</label>
          <p class="col-sm-7">
            <a ng-href="/#/request/view/{{labRequest.processInstanceId}}">
            {{labRequest.request.title}}
            </a>
            <br>
          </p>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-3">{{ 'Created Date' | translate }}</label>
          <p class="col-sm-7">
            {{labRequest.request.dateCreated | date }}
            <br>
          </p>
        </div>

        <div ng-if="globals.currentUser.roles.indexOf('requester') == -1" >
            <!--Requester info-->
            <!--Displayed only to users with non requester role-->
            <!-- Requester -->
            <div class="form-group">
                <label class="control-label col-sm-3">{{ 'Requester' | translate }}</label>
                <p class="col-sm-7">
                    {{labRequest.requesterName}}
                    <br>
                </p>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-3">{{ 'Contact' | translate }}</label>
                <address  class="col-sm-7">
                     {{labRequest.requester.contactData.address1}}
                     <br ng-if="labRequest.requester.contactData.address1">
                     {{labRequest.requester.contactData.address2}}
                     <br ng-if="labRequest.requester.contactData.address2">
                     {{labRequest.requester.contactData.postalCode}} {{labRequest.requester.contactData.city}}
                     <br ng-if="labRequest.requester.contactData.city">
                    <span ng-if="labRequest.requester.contactData.telephone">
                        <span><i class="glyphicon glyphicon-earphone"></i></span>
                        {{labRequest.requester.contactData.telephone}}
                    </span>
                    <br ng-if="labRequest.requester.contactData.telephone">
                    <span><i class="glyphicon glyphicon-envelope"></i></span>
                    <a href="mailto:{{labRequest.requester.contactData.email}}">{{labRequest.requester.contactData.email}}</a>
                </address>
            </div>
        </div>

        <div>
          <!--Requester lab Info-->
          <div class="form-group">
            <label class="control-label col-sm-3">{{ 'Requester lab' | translate }}</label>
            <p class="col-sm-7">
              {{"Lab" | translate}} {{labRequest.requesterLab.number}} - {{labRequest.requesterLab.name}}
              <br>
            </p>
          </div>
            <div class="form-group">
                <label class="control-label col-sm-3">{{ 'Contact' | translate }}</label>
                <address  class="col-sm-7">
                     {{labRequest.requesterLab.contactData.address1}}
                     <br ng-if="labRequest.requesterLab.contactData.address1">
                     {{labRequest.requesterLab.contactData.address2}}
                     <br ng-if="labRequest.requesterLab.contactData.address2">
                     {{labRequest.requesterLab.contactData.postalCode}} {{labRequest.requesterLab.contactData.city}}
                     <br ng-if="labRequest.requesterLab.contactData.city">
                    <span ng-if="labRequest.requesterLab.contactData.telephone">
                        <span><i class="glyphicon glyphicon-earphone"></i></span>
                        {{labRequest.requesterLab.contactData.telephone}}
                    </span>
                    <br ng-if="labRequest.requesterLab.contactData.telephone">
                    <span><i class="glyphicon glyphicon-envelope"></i></span>
                    <a href="mailto:{{labRequest.requesterLab.contactData.email}}">{{labRequest.requesterLab.contactData.email}}</a>
                </address>
            </div>
        </div>

        <div ng-if="!isLabUser()" >
          <!--Lab Info-->
          <!--Displayed only to users with non lab user role-->
          <div class="form-group">
            <label class="control-label col-sm-3">{{ 'Lab' | translate }}</label>
            <p class="col-sm-7">
              {{"Lab" | translate}} {{labRequest.lab.number}} - {{labRequest.lab.name}}
              <br>
            </p>
          </div>
            <div class="form-group">
                <label class="control-label col-sm-3">{{ 'Contact' | translate }}</label>
                <address  class="col-sm-7">
                     {{labRequest.lab.contactData.address1}}
                     <br ng-if="labRequest.lab.contactData.address1">
                     {{labRequest.lab.contactData.address2}}
                     <br ng-if="labRequest.lab.contactData.address2">
                     {{labRequest.lab.contactData.postalCode}} {{labRequest.lab.contactData.city}}
                     <br ng-if="labRequest.lab.contactData.city">
                    <span ng-if="labRequest.lab.contactData.telephone">
                        <span><i class="glyphicon glyphicon-earphone"></i></span>
                        {{labRequest.lab.contactData.telephone}}
                    </span>
                    <br ng-if="labRequest.lab.contactData.telephone">
                    <span><i class="glyphicon glyphicon-envelope"></i></span>
                    <a href="mailto:{{labRequest.lab.contactData.email}}">{{labRequest.lab.contactData.email}}</a>
                </address>
            </div>
        </div>

        <!--Excerpt List Details-->

        <div style="clear: both;" class="row">
            <br>
            <h3>{{ 'Excerpt list' | translate}}</h3>
        </div>

        <div style="overflow: scroll; border: 5px #CCC solid; font-size: smaller;">
          <table st-table="rowCollection" class="table">
            <thead>
            <tr>
              <th></th>
              <th ng-repeat="value in labRequest.excerptList.columnNames track by $index">{{value}}</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="excerpt in labRequest.excerptList.entries track by excerpt.id" >
              <td cs-select="row"></td>
              <td  ng-repeat="value in excerpt.values track by $index">
                {{value}}
              </td>
            </tr>
            </tbody>
          </table>
        </div>
        
        <!--Comments-->
        <div ng-include="'app/lab-request/comments.html'"></div>
        
        
      </div> <!-- end of main -->

    </div> <!--end row-->
</div>
<br>
<br>

