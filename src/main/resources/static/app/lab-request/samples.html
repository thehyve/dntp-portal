<div class="container-fluid" ng-controller="LabRequestController">
    <div class="row">

        <!--Side Bar-->
        <div class="col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                <li class="active"><a href="#/">{{'View'|translate}}</a></li>
            </ul>
        </div>

        <div ng-if="!authenticated">
            <div class="alert alert-danger" role="alert">
                {{ 'Not logged in' | translate }}
            </div>
        </div>

        <div ng-if="!samples" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <div ng-show="error" class="alert alert-danger" role="alert">
                {{ error | translate }}
            </div>
        </div>

        <!--Main-->
        <div ng-if="samples" class="col-md-10 col-md-offset-2 form-horizontal main ">

        <h3>{{ 'PA numbers' | translate}}</h3>
        <hr>
        <table st-table="paNumbersDisplayedCollection"
            st-safe-src="samples"
            class="table table-striped">
            <thead>
                <tr>
                    <th st-sort="labRequestCode">{{'Lab request' | translate}}</th>
                    <th st-sort="paNumber">{{'PA number' | translate}}</th>
                    <th>{{'Samples' | translate}}</th>
                    <th st-sort="status">{{'Status' | translate}}</th>
                    <th>{{'Actions' | translate}}</th>
                </tr>
                <tr>
                    <th><input st-search="labRequestCode" placeholder="{{'Filter by id'|translate}}" class="input-sm form-control" type="search"/></th>
                    <th><input st-search="paNumber" placeholder="{{'Filter by PA number'|translate}}" class="input-sm form-control" type="search"/></th>
                    <th><input st-search="samples" placeholder="{{'Filter by samples'|translate}}" class="input-sm form-control" type="search"/></th>
                    <th><input st-search="status" placeholder="{{'Filter by status'|translate}}" class="input-sm form-control" type="search"/></th>
                    <th>&nbsp;</th>
                </tr>
                <tr>
                    <th colspan="6"><input id="request-search"
                        st-search="" class="form-control"
                        placeholder="{{'Search'|translate}} ..." type="text" /></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="pathology in paNumbersDisplayedCollection">
                    <td>
                        <a ng-href="/#/lab-request/view/{{pathology.labRequestId}}">{{pathology.labRequestCode}}</a>
                    </td>
                    <td>{{pathology.paNumber}}</td>
                    <td><tags-input
                            on-tag-added="updatePathology(labRequest, pathology)"
                            on-tag-removed="updatePathology(labRequest, pathology)"
                            replace-spaces-with-dashes="false"
                            ng-model="pathology.samples"
                            placeholder="Enter sample codes"
                            add-on-enter="true" add-on-blur="true"
                            add-on-paste="true"
                            ng-if="labRequest.assignee == globals.currentUser.userid"></tags-input>
                        <span
                        ng-if="labRequest.assignee != globals.currentUser.userid">
                            <span
                            ng-repeat="sample in pathology.samples">
                                <label class="label label-primary">{{sample}}</label>
                        </span>
                    </span></td>
                    <td>{{pathology.status}}</td>
                    <td>
                        <span class="pull-right">
                        <span class="btn-group">
                            <a href="mailto:{{pathology.email}}?subject=Recall sample {{pathology.paNumber}}&amp;
                            body=Please return sample {{pathology.paNumber}} a.s.a.p."
                                ng-if="pathology.status=='Received'">
                            <button
                                class="btn btn-default" type="button" title="{{'Recall sample' | translate}}">
                                <span><i class="glyphicon glyphicon-envelope"></i></span>
                                {{'Compose recall mail' | translate}}
                            </button></a>
                        </span>
                        </span>
                    
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="6" class="text-center">
                        <div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="10"></div>
                    </td>
                </tr>
            </tfoot>
        </table>

        </div> <!-- end of main -->
    </div> <!--end row-->
</div> <!--end container-->
<br>
<br>
