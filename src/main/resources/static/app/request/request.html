<div class="container-fluid" ng-controller="RequestController">
    <div class="row">

        <!--Side Bar-->
        <div class="col-sm-3 col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                <li class="active"><a href="#/">View</a></li>
            </ul>
        </div>

        <!--Main-->
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

            <h2>{{request.processInstanceId}} - {{ 'Request' | translate }} {{request.title}}</h2>
            <hr>

            <div style="padding-bottom: 25px;">
                <button class="btn btn-default" type="button"  ng-click="edit(request);" title="Edit"
                        ng-if="(request.status != 'Closed') && (request.status != 'Rejected') && 
                        (
                        (request.status == 'Open' && globals.currentUser.roles.indexOf('requester') != -1) 
                        || (request.status != 'DataDelivery' && globals.currentUser.roles.indexOf('palga') != -1)
                        )"
                        ng-disabled="globals.currentUser.roles.indexOf('palga') != -1 && request.assignee != globals.currentUser.userid">
                    <span><i class="glyphicon glyphicon-pencil"></i></span>
                    {{'Edit' | translate}}
                </button>
                <button ng-if="globals.currentUser.roles.indexOf('palga') != -1"  class="btn btn-default" type="button"  ng-click="focus('#noteText');" title="{{'Notes' | translate}}">
                    <span><i class="glyphicon glyphicon-comment"></i></span>
                    {{'Notes' | translate}}
                </button>
                <a href="mailto:{{request.requesterEmail}}?subject=Request rejected&amp;body=Request rejected.%0AReject reason: {{request.rejectReason}}
                ">
                <button ng-if="globals.currentUser.roles.indexOf('palga') != -1 && request.status == 'Rejected'"  
                class="btn btn-default" type="button" title="{{'Mail requester' | translate}}">
                    <span><i class="glyphicon glyphicon-envelope"></i></span>
                    {{'Mail requester' | translate}}
                </button>
                </a>
                <button ng-if="(request.status != 'Closed') && (request.status != 'Rejected') && 
                (globals.currentUser.roles.indexOf('palga') != -1)" ng-show="request.assignee != globals.currentUser.userid" 
                class="btn btn-default" type="button"  ng-click="claim(request);" title="Claim">
                    <span><i class="glyphicon glyphicon-eye-open"></i></span>
                    {{'Claim' | translate}}
                </button>
                <button ng-if="globals.currentUser.roles.indexOf('palga') != -1" ng-show="request.assignee == globals.currentUser.userid" class="btn btn-default" type="button"  ng-click="unclaim(request);" title="Claim">
                    <span><i class="glyphicon glyphicon-eye-close"></i></span>
                    {{'Unclaim' | translate}}
                </button>
                <button class="btn btn-default" type="button"  ng-click="remove(request)" title="{{'Delete' | translate}}"
                        ng-if="request.status == 'Open'">
                    <span><i class="glyphicon glyphicon-trash"></i></span>
                    {{'Delete' | translate}}
                </button>
            </div>

            <!-- Alert -->
            <div ng-repeat="alert in alerts" class="alert alert-{{alert.type}}" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="closeAlert();">
                    <span aria-hidden="true">&times;</span>
                </button>
                {{alert.msg | translate}}
            </div>


            <!-- Status -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Status' | translate }}</label>
                <p class="col-sm-7">
                    {{request.status}}
                    <br>
                </p>
            </div>

            <!-- Reject reason  -->
            <div class="row" ng-if="request.status == 'Rejected'">
                <label class="control-label col-sm-3">{{ 'Reject reason' | translate }}</label>
                <p class="col-sm-7">
                    {{request.rejectReason}}
                    <br>
                </p>
            </div>

            <!-- Requester -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Requester' | translate }}</label>
                <p class="col-sm-7">
                    {{request.requesterName}}
                    <br>
                </p>
            </div>
            <div class="row" ng-if="request.requester.contactData">
                <label class="control-label col-sm-3">{{ 'Contact data' | translate }}</label>
                <address  class="col-sm-7">
                     {{request.requester.contactData.address1}}
                     <br ng-if="request.requester.contactData.address1">
                     {{request.requester.contactData.address2}}
                     <br ng-if="request.requester.contactData.address2">
                     {{request.requester.contactData.postalCode}} {{request.requester.contactData.city}}
                    <span ng-if="request.requester.contactData.telephone">
                        <span><i class="glyphicon glyphicon-earphone"></i></span> 
                        {{request.requester.contactData.telephone}}
                    </span>
                    <br ng-if="request.requester.contactData.telephone">
                    <span><i class="glyphicon glyphicon-envelope"></i></span>
                    <a href="mailto:{{request.requester.contactData.email}}">{{request.requester.contactData.email}}</a>
                </address>
            </div>

            <h3>{{ 'Details' | translate }}</h3>
            <hr>


            <!-- Principal Investigator -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Principal Investigator' | translate }}</label>
                <p class="col-sm-7">
                    {{request.contactPersonName}}
                </p>
            </div>

            <!-- Title -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Title' | translate }}</label>
                <p class="col-sm-7">
                    {{request.title}}
                </p>
            </div>

            <!-- Research Question -->
            <div class="row">
                <label class="control-label col-sm-3">{{ ' Research Question' | translate }}</label>
                <div class="col-sm-7">
                    {{request.researchQuestion}}
                </div>
            </div>

            <!-- Hypothesis -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Hypothesis' | translate }}</label>
                <div class="col-sm-7">
                    {{request.hypothesis}}
                </div>
            </div>

            <!-- Methods -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Methods' | translate }}</label>
                <div class="col-sm-7">
                    {{request.methods}}
                </div>
            </div>

            <!-- Request Type -->
            <div class="row">
                <label class="control-label col-sm-3">{{ 'Request Type' | translate }}</label>
                <div class="col-sm-7" ng-init="">
                    {{"Request_Type_" + request.type | translate}}
                </div>
            </div>

<!--
            <div class="row">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>

                <div class="col-sm-7">
                    <span><i class="glyphicon {{request.statisticsRequest ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                    &nbsp; {{ 'Request for statistic.' |
                    translate }}
                </div>
            </div>

            <div class="row">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>

                <div class="col-sm-7">
                    <span><i class="glyphicon {{request.excerptsRequest ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                    &nbsp; {{ 'Request for Palga excerpts.' |
                    translate }}
                </div>
            </div>


            <div class="row">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>

                <div class="col-sm-7">
                    <span><i class="glyphicon {{request.paReportRequest ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                    &nbsp; {{ 'Request for PA reports (intermediate procedure).' |
                    translate }}
                </div>
            </div>


            <div class="row">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>
                <div class="col-sm-7">
                    <span><i class="glyphicon {{request.materialsRequest ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                    &nbsp; {{ 'Request for samples (ffpe/coupus) (intermediate procedure).' |
                    translate }}
                </div>
            </div>

            <div class="row" ng-show="request.materialsRequest">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>
                <div class="col-sm-7">
                    <label class="control-label">
                        <span><i class="glyphicon glyphicon-calendar"></i></span>
                        &nbsp; {{'Return date'|translate}}:
                    </label>
                    {{request.returnDate | date: 'EEE dd MMMM yyyy'}}
                    <br>
                </div>
            </div>
-->


            <!-- Data Linkage -->
            <div class="row" ng-show="request.type != '1'">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>

                <div class="col-sm-7">
                    <span><i class="glyphicon {{request.linkageWithPersonalData ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                    &nbsp;{{'Data linkage'|translate}} 
                    <br>
                    (<em><span ng-if="request.linkageWithPersonalData">{{ 'Linkage with own or external personal data.' |
                    translate }}</span><span 
                    ng-if="!request.linkageWithPersonalData">{{ 'No data linkage required.' |
                    translate }}</span></em>)
                </div>
            </div>

            <!-- Informed Consent -->
            <div class="row" ng-show="request.type != '1'">
                <label class="control-label col-sm-3">
                    &nbsp;
                </label>

                <div class="col-sm-7">
                    <span><i class="glyphicon {{request.informedConsent ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                    &nbsp; {{ 'Informed Consent.' |
                    translate }}
                </div>
            </div>

            <!-- Reason Using Personal Data -->
            <div class="row" ng-show="request.type != '1'">
                <label class="control-label col-sm-3">{{ 'Reason using personal data' | translate }}</label>
                <div class="col-sm-7">
                    {{request.reasonUsingPersonalData}}
                </div>
            </div>

            <br>

            <h4>{{ 'Attachments' | translate }}</h4>
            <hr>

            <div ng-show="request.attachments.length < 1"><p><i>{{'No attachment found.' | translate}}</i></p></div>

            <ul class="list-group" id="attachments">
                <li class="list-group-item" ng-repeat="file in request.attachments">
                    <label><a ng-href="/requests/{{request.processInstanceId}}/files/{{file.id}}">{{file.name}}</a></label>
                </li>
            </ul>


            <div ng-if="request.status=='Review' && roles.indexOf('palga') != -1">
                <br>

                <h3>{{'Checks by Palga'|translate}}</h3>
                <hr>

                <!-- Requester valid -->
                <div class="row">
                    <label class="control-label col-sm-3">
                        &nbsp;
                    </label>
                    <div class="col-sm-7">
                        <span><i class="glyphicon {{request.requesterValid ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                        &nbsp; {{ 'The requester has been checked and is valid.' | translate }}
                    </div>
                </div>

                <!-- Lab -->
                <div class="row">
                    <br>
                    <label class="control-label col-sm-3">
                       {{'Lab' | translate}}
                    </label>
                    <div class="col-sm-7">
                        <span ng-if="request.lab.number">{{request.lab.number}} {{request.lab.name}}</span>
                        <div ng-if="!request.lab.number" class="alert alert-warning"><em>{{'No lab selected.'|translate}}</em></div>
                    </div>
                </div>
                <div class="row">
                    <label class="control-label col-sm-3">
                        &nbsp;
                    </label>
                    <div class="col-sm-7">
                        <span><i class="glyphicon {{request.requesterLabValid ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                        &nbsp; {{ 'The requester has been confirmed to be associated with the lab.' | translate }}
                    </div>
                </div>

                <!-- Requester allowed -->
                <div class="row">
                    <label class="control-label col-sm-3">
                        &nbsp;
                    </label>
                    <div class="col-sm-7">
                        <span><i class="glyphicon {{request.requesterAllowed ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                        &nbsp; {{ 'The requester is allowed to file the request.' | translate }}
                    </div>
                </div>

                <!-- Contact person allowed -->
                <div class="row">
                    <label class="control-label col-sm-3">
                        &nbsp;
                    </label>
                    <div class="col-sm-7">
                        <span><i class="glyphicon {{request.contactPersonAllowed ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                        &nbsp; {{ 'The contact person been checked and is authorised to support the request.' | translate }}
                    </div>
                </div>

                <h4>{{'Signed Agreement'|translate}}</h4>
                <hr>

                <!-- Agreement reached -->
                <div class="row">
                    <label class="control-label col-sm-3">
                        &nbsp;
                    </label>
                    <div class="col-sm-7">
                        <span><i class="glyphicon {{request.agreementReached ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                        &nbsp; {{ 'Agreement has been reached.' | translate }}
                    </div>
                </div>

                <ul class="list-group">
                    <li class="list-group-item" ng-repeat="file in request.agreementAttachments">
                        <label><a ng-href="/requests/{{request.processInstanceId}}/files/{{file.id}}">{{file.name}}</a></label>
                    </li>
                </ul>

                <br>

            </div>
            
            
            <div ng-if="request.status=='Approval' && roles.indexOf('palga') != -1">

                <!--*****************-->
                <!--Privacy Committee-->
                <!--*****************-->
                <br>

                <h3>{{'Privacy committee checks'|translate}}</h3>
                <hr>

                <!-- Has this request has been sent to Privacy Committee -->
                <div class="row">
                    <label class="control-label col-sm-3">
                        &nbsp;
                    </label>
                    <div class="col-sm-7">
                        <span><i class="glyphicon {{request.sentToPrivacyComm ? 'glyphicon-check' : 'glyphicon-unchecked'}}"></i></span>
                        &nbsp; {{ 'This request has been sent to Privacy Committee to be checked.' | translate }}
                    </div>
                </div>

                <!-- Outcome -->
                <div class="row">
                    <label class="control-label col-sm-3">{{ 'Outcome' | translate }}</label>
                    <div class="col-sm-7">
                        {{request.privacyCommitteeOutcome}}
                    </div>
                </div>

                <!-- Outcome Reference -->
                <div class="row">
                    <label class="control-label col-sm-3">{{ 'Outcome Reference' | translate }}</label>
                    <div class="col-sm-7">
                        {{request.privacyCommitteeOutcomeRef}}
                    </div>
                </div>

                <!-- Outcome Emails -->
                <div class="row">
                    <label class="control-label col-sm-3">{{ 'Emailing History' | translate }}</label>
                    <div class="col-sm-7">
                        {{request.privacyCommitteeEmails}}
                    </div>
                </div>

                <br>

                </div>
                
                
                <!-- If in 'Approval' status and user type 'palga' or 'scientific_council' -->
                <div ng-if="request.status=='Approval' &&
                    (   globals.currentUser.roles.indexOf('palga') != -1
                     || globals.currentUser.roles.indexOf('scientific_council') != -1)">

                    <h3>{{'Approval by the scientific council'|translate}}</h3>
                    <hr>
                    
                    <h4>{{'Votes'|translate}}</h4>
                    <hr>
                    <!-- Status -->
                    <div class="row">
                        <label class="control-label col-sm-3">{{ 'Votes' | translate }}</label>
                        <div class="col-sm-8">
                        <div class="panel panel-default">
                            <div class="panel-body">
                            {{size(request.approvalVotes)}} votes.
                            </div>
                        </div>
                         <div class="panel panel-default"  ng-repeat="(user_id, vote) in request.approvalVotes">
                            <div class="panel-body">
                            <span ng-if="vote.value=='ACCEPTED'"><i class="glyphicon glyphicon-ok-circle"></i></span>
                            <span ng-if="vote.value=='REJECTED'"><i class="glyphicon glyphicon-ban-circle"></i></span>
                            <span ng-if="vote.value=='NONE'"><i class="glyphicon glyphicon-question-sign"></i></span>
                            {{vote.value}} &nbsp; <small ng-if="getName(vote.creator)">({{getName(vote.creator)}})</small>
                            </div>
                        </div>
                        </div>
                    </div>
                    <!-- Add vote -->
                    <div ng-if="globals.currentUser.roles.indexOf('scientific_council') != -1" class="row" ng-class="">
                        <div class="col-sm-8">
                           <!-- {{request.approvalVotes[globals.currentUser.userid].value}} -->
                           <button class="btn btn-default {{request.approvalVotes[globals.currentUser.userid].value=='ACCEPTED'?'active':''}}"
                            type="button" title="{{'Accepted'|translate}}"
                            ng-click="updateVote(request, 'ACCEPTED')"
                            ng-if="!edit_comment.id">
                            <span><i class="glyphicon glyphicon-ok-circle"></i></span>
                            {{'Accepted'|translate}}
                            </button>
                           <button class="btn btn-default {{request.approvalVotes[globals.currentUser.userid].value=='REJECTED'?'active':''}}"
                            type="button" title="{{'Rejected'|translate}}"
                            ng-click="updateVote(request, 'REJECTED')"
                            ng-if="!edit_comment.id">
                            <span><i class="glyphicon glyphicon-ban-circle"></i></span>
                            {{'Rejected'|translate}}
                            </button>
                        </div>
                    </div>
                    <br>

                    <h4>{{'Discussion'|translate}}</h4>
                    <hr>
                    <ul class="list-group">
                    <li class="list-group-item" ng-repeat="comment in request.approvalComments">
                        <p><div ng-show="!approval_comment_edit_visibility[comment.id]">{{comment.contents}}</div>
                            <div ng-show="approval_comment_edit_visibility[comment.id]">
                           <textarea name="commentText" placeholder="{{'Add comment'|translate}}"
                            ng-model="comment.contents">
                           </textarea>
                           <button class="btn btn-default" type="button" title="{{'Update comment'|translate}}"
                            ng-click="updateComment(request, comment)">
                            {{'Update comment'|translate}}
                            </button>
                            </div>
                        <span class="pull-right" ng-if="globals.currentUser.id==comment.creator.id">
                        <span class="btn-group btn-group-xs">
                            <button class="btn btn-info {{comment_edit_visibility[comment.id] ? 'active' : ''}}" type="button" title="Edit"
                                ng-click="comment_edit_visibility[comment.id] = 1">
                                <span><i class="glyphicon glyphicon-pencil"></i></span>
                                </button>
                            <button class="btn btn-danger" type="button" title="Delete"
                                ng-click="removeApprovalComment(comment)">
                                <span><i class="glyphicon glyphicon-remove-circle"></i></span>
                            </button>
                        </span>
                        </span>
                        </p>
                        <p>
                        <small>
                        <span><i class="glyphicon glyphicon-user"></i></span>
                        <em>{{getName(comment.creator)}}</em>
                        &nbsp;
                        <span><i class="glyphicon glyphicon-time"></i></span>
                        <span>{{comment.timeCreated | date: 'EEE dd MMMM yyyy  HH:mm'}}</span>
                        <span ng-if="comment.timeEdited != comment.timeCreated">(Last edited: {{comment.timeEdited | date: 'EEE dd MMMM yyyy  HH:mm'}})</span>
                        </small>
                        </p>
                    </li>
                    </ul>

                    <!-- Add approval comment -->
                    <div class="row" ng-class="">
                        <div class="col-sm-12">
                            <input type="hidden" ng-model="approval_comment.processInstanceId" value="{{request.processInstanceId}}">
                            <textarea class="form-control" id="commentText" name="commentText" placeholder="{{'Add comment'|translate}}"
                                      ng-model="approval_comment.contents">
                            </textarea>
                        </div>
                    </div>
                    <div class="row" ng-class="">
                        <div class="col-sm-12 text-justify">
                            <br>
                            <button class="btn btn-default" type="button" title="{{'Add comment'|translate}}"
                                    ng-click="addApprovalComment(request, approval_comment)"
                                    ng-if="!approval_comment.id">
                                {{'Add comment'|translate}}
                            </button>
                            <button class="btn btn-default" type="button" title="{{'Update comment'|translate}}"
                                    ng-click="updateApprovalComment(request, approval_comment)"
                                    ng-if="approval_comment.id">
                                {{'Update comment'|translate}}
                            </button>
                        </div>
                    </div>
                    <br>
                </div> <!-- endif 'Approval' status and user type 'palga' or 'scientific_council' -->
                
                
                <div ng-if="globals.currentUser.roles.indexOf('palga') != -1">

                <!--###################################-->
                <!-- START COMMENTS-->
                <!--TODO: Refactor-->
                <!--###################################-->

                <h3>
                   {{'Notes'|translate}}
                   <span class="badge">{{request.comments.length}}</span> 
                </h3>
                <hr>

                <div>
                    <ul class="list-group">
                        <li class="list-group-item" ng-repeat="comment in request.comments">
                            <p><div ng-show="!comment_edit_visibility[comment.id]">{{comment.contents}}</div>
                            <div ng-show="comment_edit_visibility[comment.id]">
                                   <textarea id="editCommentText" name="editCommentText" placeholder="{{'Add note'|translate}}"
                                             ng-model="comment.contents">
                                   </textarea>
                                <button class="btn btn-default" type="button" title="{{'Update note'|translate}}"
                                        ng-click="updateComment(request, comment)">
                                    {{'Update note'|translate}}
                                </button>
                            </div>
                                <span class="pull-right">
                                    <span class="btn-group btn-group-xs">
                                        <button class="btn btn-info" type="button" title="Edit"
                                                ng-click="comment_edit_visibility[comment.id] = 1">
                                            <span><i class="glyphicon glyphicon-pencil"></i></span>
                                        </button>
                                        <button class="btn btn-danger" type="button" title="Delete"
                                                ng-click="removeComment(comment)">
                                            <span><i class="glyphicon glyphicon-remove-circle"></i></span>
                                        </button>
                                    </span>
                                </span>
                            </p>
                            <p>
                                <small>
                                    <span><i class="glyphicon glyphicon-user"></i></span>
                                    <em>{{getName(comment.creator)}}</em>
                                    &nbsp;
                                    <span><i class="glyphicon glyphicon-time"></i></span>
                                    <span>{{comment.timeCreated | date: 'EEE dd MMMM yyyy  HH:mm'}}</span>
                                    <span ng-if="comment.timeEdited != comment.timeCreated">(Last edited: {{comment.timeEdited | date: 'EEE dd MMMM yyyy  HH:mm'}})</span>
                                </small>
                            </p>
                        </li>
                    </ul>
                </div>

                <!-- Add comment -->
                <input type="hidden" ng-model="edit_comment.processInstanceId" value="{{request.processInstanceId}}">
                <textarea class="form-control" id="noteText" name="commentText" placeholder="{{'Add note'|translate}}"
                          ng-model="edit_comment.contents">
                </textarea>
                <br>
                <button class="btn btn-default" type="button" title="{{'Add note'|translate}}"
                        ng-click="addComment(request, edit_comment)"
                        ng-if="!edit_comment.id">
                    {{'Add note'|translate}}
                </button>
                <button class="btn btn-default" type="button" title="{{'Update note'|translate}}"
                        ng-click="updateComment(request, edit_comment)"
                        ng-if="edit_comment.id">
                    {{'Update note'|translate}}
                </button>

                <!-- END COMMENTS-->

            </div>

            <!-- If in 'DataDelivery' status -->
            <div ng-if="request.status=='DataDelivery'">
                <h4>{{'Excerpt list'|translate}}</h4>
                <hr>
                <label ng-if="request.excerptList">
                    <a ng-href="/requests/{{request.processInstanceId}}/excerptList/csv">excerpts_{{request.processInstanceId}}.csv</a>
                </label>
                
                <div flow-init="flow_options({target:'/requests/'+request.processInstanceId+'/excerptList'})"
                     flow-name="excerptListFlow"
                     flow-files-submitted="$flow.upload()"
                     flow-file-success="fileuploadsuccess(request, $message)"
                     ng-if="globals.currentUser.roles.indexOf('palga') != -1"
                        >
                    <div>
                        <span class="btn btn-default" flow-btn>{{'Upload excerpt list'|translate}}</span>
                    </div>
                    <br>
                    <div class="alert" flow-drop style="border: 2px dashed gray; text-align: center"
                         flow-drag-enter="style={border:'4px dashed lightgreen'}"
                         flow-drag-leave="style={border: '2px dashed gray'}"
                         ng-style="style">
                        ({{'drag and drop your file here'|translate}})
                    </div>
                </div>
                
                <h4>{{'Other data files'|translate}}</h4>
                <hr>
                <ul class="list-group">
                    <li class="list-group-item" ng-repeat="file in request.dataAttachments">
                        <label><a ng-href="/requests/{{request.processInstanceId}}/files/{{file.id}}">{{file.name}}</a></label>
                        <span class="pull-right">
                        <span class="btn-group">
                            <button class="btn btn-default" type="button" title="Delete"
                                    ng-click="removeDataFile(file)"
                                    >
                                Delete
                            </button>
                        </span>
                        </span>
                    </li>
                </ul>
                <p ng-if="!request.dataAttachments">
                    {{'No data files'|translate}}
                </p>

                <div flow-init="flow_options({target:'/requests/'+request.processInstanceId+'/dataFiles'})"
                     flow-name="dataFlow"
                     flow-files-submitted="uploadDataFile($flow)"
                     flow-file-success="fileuploadsuccess(request, $message)"
                     ng-if="globals.currentUser.roles.indexOf('palga') != -1"
                        >
                    <p>
                    (<em>{{'Maximum file size 10 MB.'|translate}}</em>)
                    </p>
                    <div>
                        <span class="btn btn-default" flow-btn>{{'Upload data files'|translate}}</span>
                    </div>
                    <br>
                    <div class="alert" flow-drop style="border: 2px dashed gray; text-align: center"
                         flow-drag-enter="style={border:'4px dashed lightgreen'}"
                         flow-drag-leave="style={border: '2px dashed gray'}"
                         ng-style="style">
                        ({{'drag and drop your file here'|translate}})
                    </div>
                </div>

            </div> <!-- endif DataDelivery -->

        </div>

    </div> <!--end row-->
</div>
<br>
<br>
